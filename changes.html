<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">

<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>Changes - Using dbcrossbar</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="dbcrossbar copies tabular data between PostgreSQL, BigQuery, CSV and many other databases and formats.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff" />

    <!-- dbcrossbar metadata for social media "unfurling" -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.dbcrossbar.org/">
    <meta property="og:title" content="Changes - Using dbcrossbar">
    <meta property="og:description" content="dbcrossbar copies tabular data between PostgreSQL, BigQuery, CSV and many other databases and formats.">
    <meta property="og:image" content="https://www.dbcrossbar.org/dbcrossbar_intro.png">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="www.dbcrossbar.org">
    <meta property="twitter:title" content="Changes - Using dbcrossbar">
    <meta property="twitter:description" content="dbcrossbar copies tabular data between PostgreSQL, BigQuery, CSV and many other databases and formats.">
    <meta property="twitter:image" content="https://www.dbcrossbar.org/dbcrossbar_intro.png">
    <meta property="twitter:url" content="https://www.dbcrossbar.org/">

    <link rel="shortcut icon" href="">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/general.css">
    <link rel="stylesheet" href="css/chrome.css">
    <link rel="stylesheet" href="css/print.css" media="print">

    <!-- Fonts -->
    <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
        rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="highlight.css">
    <link rel="stylesheet" href="tomorrow-night.css">
    <link rel="stylesheet" href="ayu-highlight.css">

    <!-- Custom theme stylesheets -->
</head>

<body>
    <!-- Provide site root to javascript -->
    <script type="text/javascript">
        var path_to_root = "";
        var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
    </script>

    <!-- Work around some values being stored in localStorage wrapped in quotes -->
    <script type="text/javascript">
        try {
            var theme = localStorage.getItem('mdbook-theme');
            var sidebar = localStorage.getItem('mdbook-sidebar');

            if (theme.startsWith('"') && theme.endsWith('"')) {
                localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
            }

            if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) { }
    </script>

    <!-- Set the theme before any content is loaded, prevents flash -->
    <script type="text/javascript">
        var theme;
        try { theme = localStorage.getItem('mdbook-theme'); } catch (e) { }
        if (theme === null || theme === undefined) { theme = default_theme; }
        var html = document.querySelector('html');
        html.classList.remove('no-js')
        html.classList.remove('light')
        html.classList.add(theme);
        html.classList.add('js');
    </script>

    <!-- Hide / unhide sidebar before it is displayed -->
    <script type="text/javascript">
        var html = document.querySelector('html');
        var sidebar = 'hidden';
        if (document.body.clientWidth >= 1080) {
            try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch (e) { }
            sidebar = sidebar || 'visible';
        }
        html.classList.remove('sidebar-visible');
        html.classList.add("sidebar-" + sidebar);
    </script>

    <nav id="sidebar" class="sidebar" aria-label="Table of contents">
        <div class="sidebar-scrollbox">
            <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">dbcrossbar Guide</a></li><li class="chapter-item expanded "><a href="features.html"><strong aria-hidden="true">1.</strong> Features &amp; philosophy</a></li><li class="chapter-item expanded "><a href="installing.html"><strong aria-hidden="true">2.</strong> Installing</a></li><li class="chapter-item expanded "><a href="how.html"><strong aria-hidden="true">3.</strong> How it works</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="csv_interchange.html"><strong aria-hidden="true">3.1.</strong> CSV interchange format</a></li><li class="chapter-item expanded "><a href="schema.html"><strong aria-hidden="true">3.2.</strong> Portable table schema</a></li></ol></li><li class="chapter-item expanded "><a href="config.html"><strong aria-hidden="true">4.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="commands.html"><strong aria-hidden="true">5.</strong> Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="cp.html"><strong aria-hidden="true">5.1.</strong> cp: Copying tables</a></li><li class="chapter-item expanded "><a href="count.html"><strong aria-hidden="true">5.2.</strong> count: Counting records</a></li><li class="chapter-item expanded "><a href="conv.html"><strong aria-hidden="true">5.3.</strong> schema conv: Transforming schemas</a></li></ol></li><li class="chapter-item expanded "><a href="drivers.html"><strong aria-hidden="true">6.</strong> Drivers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="bigml.html"><strong aria-hidden="true">6.1.</strong> BigML</a></li><li class="chapter-item expanded "><a href="bigquery.html"><strong aria-hidden="true">6.2.</strong> BigQuery</a></li><li class="chapter-item expanded "><a href="csv.html"><strong aria-hidden="true">6.3.</strong> CSV</a></li><li class="chapter-item expanded "><a href="gs.html"><strong aria-hidden="true">6.4.</strong> Google Cloud Storage</a></li><li class="chapter-item expanded "><a href="postgres.html"><strong aria-hidden="true">6.5.</strong> PostgreSQL</a></li><li class="chapter-item expanded "><a href="redshift.html"><strong aria-hidden="true">6.6.</strong> RedShift</a></li><li class="chapter-item expanded "><a href="s3.html"><strong aria-hidden="true">6.7.</strong> S3</a></li><li class="chapter-item expanded "><a href="shopify.html"><strong aria-hidden="true">6.8.</strong> Shopify (UNSTABLE)</a></li></ol></li><li class="chapter-item expanded "><a href="schemas.html"><strong aria-hidden="true">7.</strong> Specifying table schemas</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="postgres-sql.html"><strong aria-hidden="true">7.1.</strong> Postgres CREATE TABLE</a></li><li class="chapter-item expanded "><a href="bigquery-schema.html"><strong aria-hidden="true">7.2.</strong> BigQuery JSON schemas</a></li><li class="chapter-item expanded "><a href="dbcrossbar-schema.html"><strong aria-hidden="true">7.3.</strong> Native dbcrossbar schemas</a></li><li class="chapter-item expanded "><a href="dbcrossbar-ts.html"><strong aria-hidden="true">7.4.</strong> TypeScript schemas (UNSTABLE)</a></li></ol></li><li class="chapter-item expanded "><a href="changes.html" class="active"><strong aria-hidden="true">8.</strong> Changes</a></li><li class="chapter-item expanded affix "><a href="credits.html">Credits and contributors</a></li></ol>
        </div>
        <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
    </nav>

    <div id="page-wrapper" class="page-wrapper">

        <div class="page">
            <div id="menu-bar-hover-placeholder"></div>
            <div id="menu-bar" class="menu-bar sticky bordered">
                <div class="left-buttons">
                    <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents"
                        aria-label="Toggle Table of Contents" aria-controls="sidebar">
                        <i class="fa fa-bars"></i>
                    </button>
                    <button id="theme-toggle" class="icon-button" type="button" title="Change theme"
                        aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                        <i class="fa fa-paint-brush"></i>
                    </button>
                    <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                        <li role="none"><button role="menuitem" class="theme"
                                id="light">Light (default)</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="rust">Rust</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="coal">Coal</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="navy">Navy</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button>
                        </li>
                    </ul>
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)"
                        aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S"
                        aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
                </div>

                <h1 class="menu-title">Using dbcrossbar</h1>

                <div class="right-buttons">
                    <a href="print.html" title="Print this book" aria-label="Print this book">
                        <i id="print-button" class="fa fa-print"></i>
                    </a>
                    <a href="https://github.com/dbcrossbar/dbcrossbar" title="Git repository" aria-label="Git repository">
                        <i id="git-repository-button" class="fa fa-github"></i>
                    </a>
                </div>
            </div>

            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" name="search" id="searchbar" name="searchbar"
                        placeholder="Search this book ..." aria-controls="searchresults-outer"
                        aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>
            <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
            <script type="text/javascript">
                document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                Array.from(document.querySelectorAll('#sidebar a')).forEach(function (link) {
                    link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                });
            </script>

            <div id="content" class="content">
                <main>
                    <h1 id="changelog"><a class="header" href="#changelog">Changelog</a></h1>
<p>All notable changes to this project will be documented in this file.</p>
<p>The format is based on <a href="https://keepachangelog.com/en/1.0.0/">Keep a Changelog</a>, and this project adheres to <a href="https://semver.org/spec/v2.0.0.html">Semantic Versioning</a> for the <code>dbcrossbar</code> CLI tool. (The <code>dbcrossbarlib</code> crate is an internal-only dependency with no versioning policy at this time.)</p>
<h2 id="unreleased"><a class="header" href="#unreleased">[Unreleased]</a></h2>
<h2 id="050---2022-20-22"><a class="header" href="#050---2022-20-22">[0.5.0] - 2022-20-22</a></h2>
<h3 id="added"><a class="header" href="#added">Added</a></h3>
<ul>
<li>New <code>bigquery-test-fixture:</code> schema creates small, read-only &quot;tables&quot; very quickly. Many thanks to Dave Shirley for the proof of concept and for pairing on the final implementation.</li>
</ul>
<h3 id="fixed"><a class="header" href="#fixed">Fixed</a></h3>
<ul>
<li>Updated a few dependencies with (likely non-exploitable) security advisories. We have not update <em>all</em> our dependencies, because there are at least two regressions affecting supposedly semver-compatible dependencies. This is actually very rare in the Rust ecosystem, but we were unlucky this time.</li>
</ul>
<h2 id="050-beta4---2022-01-01"><a class="header" href="#050-beta4---2022-01-01">[0.5.0-beta.4] - 2022-01-01</a></h2>
<h3 id="fixed-1"><a class="header" href="#fixed-1">Fixed</a></h3>
<ul>
<li>gs: Retry <code>delete</code> operations after 403 Forbidden errors. This appears to be part of the same hypothesized permissions race that affected <code>extract</code> in v0.5.0-beta.3.</li>
</ul>
<h2 id="050-beta3---2021-12-31"><a class="header" href="#050-beta3---2021-12-31">[0.5.0-beta.3] - 2021-12-31</a></h2>
<h3 id="fixed-2"><a class="header" href="#fixed-2">Fixed</a></h3>
<ul>
<li>bigquery: Retry <code>extract</code> operations after <code>accessDenied</code> errors. These errors sometimes occur even when BigQuery <em>should</em> have the necessary access permissions. This may be caused by a permissions race condition somewhere in Google Cloud?</li>
</ul>
<h2 id="050-beta2---2021-12-19"><a class="header" href="#050-beta2---2021-12-19">[0.5.0-beta.2] - 2021-12-19</a></h2>
<h3 id="changed"><a class="header" href="#changed">Changed</a></h3>
<ul>
<li>The format for printing backtraces has changed. We now use the standard <code>anyhow</code> format.</li>
<li>Our logging format has changed considerably, thanks to switch from <code>slog</code> to the much more popular <code>tracing</code>. Some logging of complex async streams may be less well-organized, but there's <em>more</em> of it, especially at <code>RUST_LOG=dbcrossbarlib=trace,dbcrossbar=trace,warn</code> level.</li>
</ul>
<h3 id="fixed-3"><a class="header" href="#fixed-3">Fixed</a></h3>
<ul>
<li>We no longer rely on the unmaintained <code>failure</code>, or the less popular <code>slog</code> ecosystem.</li>
</ul>
<h3 id="removed"><a class="header" href="#removed">Removed</a></h3>
<ul>
<li>The <code>--log-format</code> and <code>--log-extra</code> commands have been removed.</li>
</ul>
<h2 id="050-beta1---2021-12-15"><a class="header" href="#050-beta1---2021-12-15">[0.5.0-beta.1] - 2021-12-15</a></h2>
<h3 id="added-1"><a class="header" href="#added-1">Added</a></h3>
<ul>
<li>We provide MacOS X binaries for the new M1 processors. These are unsigned, like our existing Apple Intel binaries. So you'll need to continue to use <code>xattr -d com.apple.quarantine dbcrossbar</code> or a similar technique to run them. Or you could build your own binaries.</li>
</ul>
<h3 id="changed-1"><a class="header" href="#changed-1">Changed</a></h3>
<ul>
<li>Our downloadable <code>*.zip</code> files follow a new naming convention, allowing us to distinguish between Intel and M1 Macs.</li>
<li>OpenSSL has been completely removed from <code>dbcrossbar</code>, allowing us to support more platforms. This will also allow us to eventually centralize TLS configuration across all <code>dbcrossbar</code> drivers.</li>
</ul>
<h3 id="removed-1"><a class="header" href="#removed-1">Removed</a></h3>
<ul>
<li>We no longer support hosted Citus from Citus Data, because their TLS certificates do not include <code>subjectAltName</code>, which is <a href="https://github.com/briansmith/webpki/issues/11">required by the <code>rustls</code> library</a>. Citus Data will be shutting down shortly, so we recommend keeping around an older <code>dbcrossbar</code> for a few more weeks if you need to talk to them.</li>
</ul>
<h2 id="050-alpha3---2021-12-14"><a class="header" href="#050-alpha3---2021-12-14">[0.5.0-alpha.3] - 2021-12-14</a></h2>
<h3 id="added-2"><a class="header" href="#added-2">Added</a></h3>
<ul>
<li>gs: Allow single-file CSV output. This involves copying out of Google Cloud Storage, concatenating, and copying back. But it's handy when you need it.</li>
</ul>
<h3 id="changed-2"><a class="header" href="#changed-2">Changed</a></h3>
<ul>
<li>gs: Copying to a <code>gs://bucket/dir/</code> URL with <code>--if-exists=overwrite --display-output-locators</code> will print out a list of files in the destination bucket directory when we're done. Before, it just printed out the destination locator, which was technically allowed, but useless.</li>
</ul>
<h3 id="fixed-4"><a class="header" href="#fixed-4">Fixed</a></h3>
<ul>
<li>Updated many dependencies, fixing several CVEs (none known to be meaningfully exploitable in typical use cases), and possibly some library bugs.</li>
</ul>
<h2 id="050-alpha2---2021-04-27"><a class="header" href="#050-alpha2---2021-04-27">[0.5.0-alpha.2] - 2021-04-27</a></h2>
<h3 id="fixed-5"><a class="header" href="#fixed-5">Fixed</a></h3>
<ul>
<li>bigml: Always map columns with a <code>one-of</code> type (aka <code>CREATE ENUM</code>) to BigML <code>categorical</code> columns.</li>
</ul>
<h2 id="050-alpha1---2021-03-04"><a class="header" href="#050-alpha1---2021-03-04">[0.5.0-alpha.1] - 2021-03-04</a></h2>
<p>This release contains a breaking change to the <code>dbcrossbar-schema</code> output format to enable supporting named types and enumeration types. See below.</p>
<h3 id="added-3"><a class="header" href="#added-3">Added</a></h3>
<ul>
<li>
<p>(EXPERIMENTAL) postgres: The <code>postgres-sql</code> and <code>postgres</code> drivers now <code>CREATE TYPE</code> statements (but only in the <code>&quot;public&quot;</code> schema). These can be used as follows:</p>
<pre><code class="language-sql">CREATE TYPE &quot;format&quot; AS ENUM ('gif', 'jpeg');
CREATE TABLE &quot;images&quot; (
    &quot;id&quot; uuid NOT NULL,
    &quot;url&quot; text NOT NULL,
    &quot;image_format&quot; &quot;format&quot;,
    &quot;metadata&quot; jsonb
);
</code></pre>
<p>This change also requires some changes to the <code>dbcrossbar-schema</code> format, which are described below.</p>
</li>
<li>
<p>(EXPERIMENTAL) The native <code>dbcrossbar-schema</code> format now supports a set of <code>named_types</code> definitions. This allows named types to be defined once, and to then be referred to elsewhere using <code>{ &quot;named&quot;: &quot;my_custom_type&quot; }</code>.</p>
</li>
<li>
<p>(EXPERIMENTAL) The native <code>dbcrossbar-schema</code> format also supports string enumeration types using a <code>{ &quot;one_of&quot;: [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;] }</code> syntax.</p>
</li>
</ul>
<h3 id="changed-3"><a class="header" href="#changed-3">Changed</a></h3>
<ul>
<li>BREAKING: The <code>dbcrossbar-schema</code> output format has changed! It now has top level <code>named_types</code> and <code>tables</code> members, and the old top-level table definition is now available as <code>.tables[0]</code>. See <a href="https://www.dbcrossbar.org/schema.html">the manual</a> for more details. However, <code>dbcrossbar</code> can still read the old input format with no problems, so this only affects other programs that parse native <code>dbcrossbar</code> schema.</li>
</ul>
<h3 id="fixed-6"><a class="header" href="#fixed-6">Fixed</a></h3>
<ul>
<li>The suggested fixes for RUSTSEC-2020-0146, RUSTSEC-2021-0020 and RUSTSEC-2021-0023 have been applied.</li>
</ul>
<h2 id="042-beta11---2021-02-03"><a class="header" href="#042-beta11---2021-02-03">0.4.2-beta.11 - 2021-02-03</a></h2>
<h3 id="fixed-7"><a class="header" href="#fixed-7">Fixed</a></h3>
<ul>
<li>gcloud: Retry OAuth2 failures for service accounts.</li>
</ul>
<h2 id="042-beta10---2021-02-02"><a class="header" href="#042-beta10---2021-02-02">0.4.2-beta.10 - 2021-02-02</a></h2>
<h3 id="fixed-8"><a class="header" href="#fixed-8">Fixed</a></h3>
<ul>
<li>Build fixes for recently-added clippy warnings.</li>
</ul>
<h2 id="042-beta9---2021-01-14"><a class="header" href="#042-beta9---2021-01-14">0.4.2-beta.9 - 2021-01-14</a></h2>
<h3 id="changed-4"><a class="header" href="#changed-4">Changed</a></h3>
<ul>
<li>Update many dependencies, including <code>tokio</code> and our many network-related libraries. Tests pass, but this affects almost everything, in one fashion or another.</li>
</ul>
<h2 id="042-beta8---2020-10-16"><a class="header" href="#042-beta8---2020-10-16">0.4.2-beta.8 - 2020-10-16</a></h2>
<h3 id="fixed-9"><a class="header" href="#fixed-9">Fixed</a></h3>
<ul>
<li>Linux: Fix Linux binary builds by updating to latest <code>rust-musl-builder</code> release, which has the new <code>cargo-deny</code>.</li>
</ul>
<h2 id="042-beta7---2020-10-14"><a class="header" href="#042-beta7---2020-10-14">0.4.2-beta.7 - 2020-10-14</a></h2>
<h3 id="added-4"><a class="header" href="#added-4">Added</a></h3>
<ul>
<li>shopify: Added a &quot;partner&quot; argument which can be used to include a &quot;-- partner:&quot; comment in all generated RedShift SQL for use by RedShift partners.</li>
</ul>
<h2 id="042-beta6---2020-09-15"><a class="header" href="#042-beta6---2020-09-15">0.4.2-beta.6 - 2020-09-15</a></h2>
<h3 id="fixed-10"><a class="header" href="#fixed-10">Fixed</a></h3>
<ul>
<li>shopify: Retry failed downloads a few times. We've been seeing some intermittent failures.</li>
</ul>
<h2 id="042-beta5---2020-08-01"><a class="header" href="#042-beta5---2020-08-01">0.4.2-beta.5 - 2020-08-01</a></h2>
<h3 id="fixed-11"><a class="header" href="#fixed-11">Fixed</a></h3>
<ul>
<li>gcloud: We now print more useful error messages when Google doesn't send JSON-formatted errors.</li>
<li>gcloud: We now retry Google Cloud GET requests automatically a few times if it looks like it might help. We'd also love to retry POST requests, but that will require the ability to try to restart streams.</li>
</ul>
<h2 id="042-beta4---2020-07-07"><a class="header" href="#042-beta4---2020-07-07">0.4.2-beta.4 - 2020-07-07</a></h2>
<h3 id="changed-5"><a class="header" href="#changed-5">Changed</a></h3>
<ul>
<li>Update dependencies. The latest <code>bigml</code> release contains tweaks to error retry behavior.</li>
</ul>
<h2 id="042-beta3---2020-07-07"><a class="header" href="#042-beta3---2020-07-07">0.4.2-beta.3 - 2020-07-07</a></h2>
<h3 id="changed-6"><a class="header" href="#changed-6">Changed</a></h3>
<ul>
<li>postgres: Our last <code>diesel</code> code has been removed, and replaced with <code>tokio-postgres</code> (which we use elsewhere).</li>
</ul>
<h3 id="fixed-12"><a class="header" href="#fixed-12">Fixed</a></h3>
<ul>
<li>postgres: Fixed <a href="https://github.com/dbcrossbar/dbcrossbar/issues/148">#148</a> to improve support for PostGIS under PostgreSQL 12.</li>
</ul>
<h3 id="removed-2"><a class="header" href="#removed-2">Removed</a></h3>
<ul>
<li>The experimental <code>citus</code>-related APIs have been removed from <code>dbcrossbarlib</code>, because they used <code>diesel</code>. This is technically a breaking change for <code>dbcrosslib</code>, but we don't claim to honor semver for <code>dbcrossbarlib</code> 0.x.y releases.</li>
</ul>
<h2 id="042-beta2---2020-06-28"><a class="header" href="#042-beta2---2020-06-28">0.4.2-beta.2 - 2020-06-28</a></h2>
<h3 id="added-5"><a class="header" href="#added-5">Added</a></h3>
<ul>
<li>redshift: Support <code>--if-exists=upsert-on:key1,key2</code>.</li>
<li>redshift: Enable <code>--if-exists=error</code>.</li>
</ul>
<h3 id="changed-7"><a class="header" href="#changed-7">Changed</a></h3>
<ul>
<li>postgres: Temporary tables now use the same schema (i.e. namespace) as the tables they're linked to. This shouldn't be a breaking change unless you've set up your database permissions to forbid it.</li>
</ul>
<h3 id="fixed-13"><a class="header" href="#fixed-13">Fixed</a></h3>
<ul>
<li>postgres: Fixed likely bug upserting into tables with a non-&quot;public&quot; schema.</li>
<li>postgres: Verify that upsert columns are NOT NULL to prevent possible incorrect upserts. This may be a breaking change, but it also prevents a possible bug.</li>
</ul>
<h2 id="042-beta1---2020-06-23"><a class="header" href="#042-beta1---2020-06-23">0.4.2-beta.1 - 2020-06-23</a></h2>
<h3 id="changed-8"><a class="header" href="#changed-8">Changed</a></h3>
<ul>
<li>Mac: Move configuration directory from <code>~/Library/Preferences/dbcrossbar</code> to <code>~/Library/Application Support/dbcrossbar</code>. If we detect a config directory in the old location, we should print a deprecation warning and use it.</li>
<li>Many dependencies have been updated.</li>
</ul>
<h3 id="fixed-14"><a class="header" href="#fixed-14">Fixed</a></h3>
<ul>
<li>We should now handle multiple sets of Google Cloud OAuth2 credentials correctly.</li>
</ul>
<h2 id="041---2020-06-16"><a class="header" href="#041---2020-06-16">0.4.1 - 2020-06-16</a></h2>
<p>A bug fix to <code>gs</code>, and other minor improvements.</p>
<h3 id="changed-9"><a class="header" href="#changed-9">Changed</a></h3>
<ul>
<li>Replace deprecated <code>tempdir</code> with <code>tempfile</code>.</li>
</ul>
<h3 id="fixed-15"><a class="header" href="#fixed-15">Fixed</a></h3>
<ul>
<li>gs: Correctly pass <code>page_token</code> when listing. This prevents an infinite loop in large directories.</li>
<li>Fix new Rust 0.44.0 warnings.</li>
</ul>
<h2 id="040---2020-06-02"><a class="header" href="#040---2020-06-02">0.4.0 - 2020-06-02</a></h2>
<p>This is a summary of all the major changes since the 0.3.3 release. For more details and minor changes, see the individual CHANGELOG entries for the 0.4.0 preleases.</p>
<h3 id="added-6"><a class="header" href="#added-6">Added</a></h3>
<ul>
<li><code>dbcrossbar</code> now supports &quot;struct&quot; types, which have a fixed set of named fields. These will be automatically translated to BigQuery STRUCT types or to JSON columns, depending on the destination database.</li>
<li>We now support a CLI-editable config file using commands like <code>dbcrossbar config add temporary s3://example/temp/</code>.</li>
<li>Parsing-related error messages should now include context.</li>
<li>bigquery: Users can now specify billing labels for jobs.</li>
<li><code>dbcrossbar license</code> will display the licences for all dependencies.</li>
<li>Unstable features can now be hidden behind the <code>--enable-unstable</code> flag, including two new drivers:
<ul>
<li>UNSTABLE: We now support specifying schemas using a subset of TypeScript.</li>
<li>UNSTABLE: We now support reading data from Shopify's REST API. This is a testbed for new struct and JSON-related features.</li>
</ul>
</li>
</ul>
<h3 id="changed-10"><a class="header" href="#changed-10">Changed</a></h3>
<ul>
<li><code>dbcrossbar conv</code> is now <code>dbcrossbar schema conv</code>.</li>
<li>Because of the new STRUCT support, some corner cases involving struct types and JSON may have changed subtly.</li>
<li>We replaced <code>gcloud auth</code>, <code>gsutil</code> and <code>bq</code> with native Rust. This simplifies installation and configuration substantially, and fixes a number of BigQuery-related issues.</li>
<li>AWS credentials must now always be passed via <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code>, <code>AWS_SESSION_TOKEN</code> (optional) and <code>AWS_DEFAULT_REGION</code> (required). This lays the groundwork for replacing the <code>aws</code> CLI tool with native Rust code, so that we will someday be able to remove our last CLI dependency.</li>
</ul>
<h3 id="fixed-16"><a class="header" href="#fixed-16">Fixed</a></h3>
<ul>
<li>Lots of issues.</li>
</ul>
<h3 id="removed-3"><a class="header" href="#removed-3">Removed</a></h3>
<ul>
<li>The data type <code>{ &quot;other&quot;: string }</code> has been removed from the portable schema format. It was not actually generated by any of our drivers.</li>
<li>bigquery: We now export <code>ARRAY&lt;STRUCT&lt;...&gt;&gt;</code> as <code>{ &quot;array&quot;: { &quot;struct&quot;: ... } }</code>, instead of exporting it as as single <code>&quot;json&quot;</code> value.</li>
</ul>
<h2 id="040-rc2---2020-06-01"><a class="header" href="#040-rc2---2020-06-01">0.4.0-rc.2 - 2020-06-01</a></h2>
<h3 id="changed-11"><a class="header" href="#changed-11">Changed</a></h3>
<ul>
<li>postgres: We now transform the portable types <code>{ &quot;array&quot;: &quot;json&quot; }</code> and <code>{ &quot;array&quot;: { &quot;struct&quot;: fields } }</code> into <code>jsonb[]</code>, instead of automatically changing it to plain <code>jsonb</code> in an effort to help our users.</li>
</ul>
<h2 id="040-rc1---2020-05-31"><a class="header" href="#040-rc1---2020-05-31">0.4.0-rc.1 - 2020-05-31</a></h2>
<p>This is a release candidate for v0.4.0. If no issues are discovered, this will be published as 0.4.0.</p>
<p>This release contains a last few breaking changes that we want to include before we publicize <code>dbcrossbar</code> more widely. When migrating, particular attention to the <code>conv</code> subcommand and <code>AWS_DEFAULT_REGION</code> below, which have significant breaking changes.</p>
<h3 id="changed-12"><a class="header" href="#changed-12">Changed</a></h3>
<ul>
<li>Rename <code>dbcrossbar conv</code> to <code>dbcrossbar schema conv</code>.</li>
<li>s3: Require <code>AWS_DEFAULT_REGION</code> instead of optionally using <code>AWS_REGION</code>. This is more compatiable with the <code>aws</code> CLI command, and it doesn't rely on undocumented region defaults or <code>aws</code> configuration files.</li>
</ul>
<h3 id="added-7"><a class="header" href="#added-7">Added</a></h3>
<ul>
<li>Document our portable schema format.</li>
<li>Document schema-only drivers.</li>
<li>Improve the documentation in other minor ways.</li>
</ul>
<h3 id="removed-4"><a class="header" href="#removed-4">Removed</a></h3>
<ul>
<li>Remove <code>DataType::Other(String)</code>, which was not actually used by any of our drivers.</li>
</ul>
<h2 id="040-beta1---2020-05-28"><a class="header" href="#040-beta1---2020-05-28">0.4.0-beta.1 - 2020-05-28</a></h2>
<p>We're finally ready to start preparing for an 0.4.0 release! This beta will be deployed to several production systems to help verify that there are no surprising regressions.</p>
<h3 id="changed-13"><a class="header" href="#changed-13">Changed</a></h3>
<ul>
<li>gs: We now verify CRC32C checksums when uploading.</li>
<li>gs: We specify <code>isGenerationMatch</code> on many operations to make sure that nothing has been created or overridden that we didn't expect.</li>
</ul>
<h2 id="040-alpha7---2020-05-26"><a class="header" href="#040-alpha7---2020-05-26">0.4.0-alpha.7 - 2020-05-26</a></h2>
<p>This release adds support for labeling BigQuery jobs.</p>
<h3 id="added-8"><a class="header" href="#added-8">Added</a></h3>
<ul>
<li>bigquery: Optionally specify billing labels for jobs. See the manual for details.</li>
<li>Allow driver argument names to be specified as either <code>x.y</code> or <code>x[y]</code>, interchangeably. This makes <code>job_labels</code> look nicer.</li>
<li>Hide URL passwords from (most) logs using a dedicated wrapper type.</li>
</ul>
<h3 id="changed-14"><a class="header" href="#changed-14">Changed</a></h3>
<ul>
<li>We now have test cases that make sure we catch duplicate driver arguments and raise an error.</li>
<li>redshift: Authentication argument names may no longer include <code>-</code> characters. I'm not even sure whether these are valid, but they won't work with the new scheme for parsing driver arguments.</li>
<li><code>DriverArguments::from_cli_args</code> now takes an iterator instead of a slice.</li>
</ul>
<h2 id="040-alpha6---2020-05-22"><a class="header" href="#040-alpha6---2020-05-22">0.4.0-alpha.6 - 2020-05-22</a></h2>
<p>This release improves the example <code>shopify.ts</code> schema, and adds new features to <code>dbcrossbar-ts</code> to parse it.</p>
<h3 id="added-9"><a class="header" href="#added-9">Added</a></h3>
<ul>
<li>dbcrossbar-ts:
<ul>
<li>Parse <code>/* */</code> comments.</li>
<li>Allow <code>Date</code> to be used as a type. This requires the date to be a string in ISO 8601 format, including a time zone.</li>
<li>Allow <code>decimal</code>, <code>int16</code>, <code>int32</code> and <code>int64</code> to be defined as any of <code>number</code>, <code>string</code>, <code>number | string</code> or <code>string | number</code>. This allows the schema to more accurately represent what appears on the wire. It allows <code>decimal</code> values to be represented as a mix of floats and strings, which is seen in Shopify.</li>
</ul>
</li>
<li>postgres-sql: Use new format for parse errors.</li>
</ul>
<h3 id="fixed-17"><a class="header" href="#fixed-17">Fixed</a></h3>
<ul>
<li>shopify: The example <code>shopify.ts</code> schema has been updated to use <code>Date</code> and <code>int64</code> in many places. <code>Address</code> and <code>CustomerAddress</code> are now distinct types, and several other minor issues have been fixed.</li>
</ul>
<h2 id="040-alpha5---2020-05-21"><a class="header" href="#040-alpha5---2020-05-21">0.4.0-alpha.5 - 2020-05-21</a></h2>
<h3 id="added-10"><a class="header" href="#added-10">Added</a></h3>
<ul>
<li>BigQuery: Support <code>--if-exists=error</code>.</li>
</ul>
<h3 id="changed-15"><a class="header" href="#changed-15">Changed</a></h3>
<ul>
<li>Require <code>--enable-unstable</code> to use <code>dbcrossbar-ts</code> or <code>shopify</code> locators, which are unstable.</li>
<li>AWS credentials must now always be passed via <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code>, <code>AWS_SESSION_TOKEN</code> (optional) and <code>AWS_REGION</code> (optional). This lays the groundwork for replacing the <code>aws</code> CLI tool with native Rust code, so that we will someday be able to remove our last CLI dependency.</li>
</ul>
<h2 id="040-alpha4---2020-05-19"><a class="header" href="#040-alpha4---2020-05-19">0.4.0-alpha.4 - 2020-05-19</a></h2>
<h3 id="added-11"><a class="header" href="#added-11">Added</a></h3>
<ul>
<li>BigQuery now imports and exports decimal (aka NUMERIC) values everywhere.</li>
<li>The <code>dbcrossbar-ts</code> driver now supports magic type aliases that will convert to the corresponding <code>dbcrossbar</code> types:
<ul>
<li><code>type decimal = string;</code></li>
<li><code>type int16 = number | string;</code></li>
<li><code>type int32 = number | string;</code></li>
<li><code>type int64 = number | string;</code></li>
</ul>
</li>
</ul>
<h3 id="changed-16"><a class="header" href="#changed-16">Changed</a></h3>
<ul>
<li>The sample <code>shopify.ts</code> schema now uses <code>decimal</code> instead of <code>string</code> when appropriate. It does not attempt to use <code>int64</code> yet.</li>
</ul>
<h2 id="040-alpha3---2020-05-19-0-yanked"><a class="header" href="#040-alpha3---2020-05-19-0-yanked">0.4.0-alpha.3 - 2020-05-19 0 YANKED</a></h2>
<p>This release was yanked because it was missing several things it should have included.</p>
<h2 id="040-alpha2---2020-05-19"><a class="header" href="#040-alpha2---2020-05-19">0.4.0-alpha.2 - 2020-05-19</a></h2>
<p>This is a significant release, with support for &quot;struct&quot; types.</p>
<h3 id="added-12"><a class="header" href="#added-12">Added</a></h3>
<ul>
<li>The portable schema now supports a <code>DataType::Struct(fields)</code> type that can be used to represent BigQuery STRUCT values (as long as they have unique, named fields) and JSON objects with known keys.</li>
<li>The BigQuery driver now supports importing and exporting <code>STRUCT</code> fields using the new <code>DataType::Struct(fields)</code> type.</li>
<li>EXPERIMENTAL: Schemas can now be specified using the <code>dbcrossbar-ts</code> driver, which supports subset of TypeScript type declarations. This is useful for specifying complex, nested structs. This can be used as <code>--schema=&quot;dbcrossbar-ts:shopify.ts#Order&quot;</code>, where <code>Order</code> is the name of the type within the <code>*.ts</code> file to use as the table's type.</li>
<li>EXPERIMENTAL: We now support a Shopify input driver that uses the Shopify REST API. See the manual for details.</li>
<li>We now have support for fancy parser error messages, which we use with the <code>dbcrossbar-ts</code> parser.</li>
<li>We now support a CLI-editable config file using commands like <code>dbcrossbar config add temporary s3://example/temp/</code>.</li>
</ul>
<h3 id="changed-17"><a class="header" href="#changed-17">Changed</a></h3>
<ul>
<li>BREAKING: Some corner cases involving struct types and JSON may have changed subtly.</li>
<li>We've upgraded to the latest <code>rust-peg</code> parser syntax everywhere.</li>
</ul>
<h3 id="fixed-18"><a class="header" href="#fixed-18">Fixed</a></h3>
<ul>
<li><code>--if-exists=overwrite</code> now overwrites when writing to local files (instead of appending).</li>
<li>We automatically create <code>~/.local/share</code> if it does not exist.</li>
<li>More <code>clippy</code> warnings have been fixed, and unsafe code has been forbidden.</li>
<li>Various obsolete casting libraries have been removed.</li>
</ul>
<h2 id="040-alpha1---2020-04-07"><a class="header" href="#040-alpha1---2020-04-07">0.4.0-alpha.1 - 2020-04-07</a></h2>
<h3 id="changed-18"><a class="header" href="#changed-18">Changed</a></h3>
<ul>
<li>Replace <code>gcloud auth</code>, <code>gsutil</code> and <code>bq</code> with native Rust. This changes how we authenticate to Google Cloud. In particular, we now support <code>GCLOUD_CLIENT_SECRET</code>, <code>~/.config/dbcrossbar/gcloud_client_secret.json</code>, <code>GCLOUD_SERVICE_ACCOUNT_KEY</code> or <code>~/.config/dbcrossbar/gcloud_service_account_key.json</code>, as <a href="https://www.dbcrossbar.org/gs.html#configuration--authentication">explained in the manual</a>. We no longer use <code>gcloud auth</code>, and the Google Cloud SDK tools are no longer required. In the current alpha version, uploads and deletions are probably slower than before.</li>
</ul>
<h3 id="fixed-19"><a class="header" href="#fixed-19">Fixed</a></h3>
<ul>
<li>gs: Avoid download stalls when backpressure is applied (<a href="https://github.com/dbcrossbar/dbcrossbar/issues/102">#103</a>).</li>
<li>bigquery: Display error messages more reliably (<a href="https://github.com/dbcrossbar/dbcrossbar/issues/110">#110</a>).</li>
<li>bigquery: Detect &quot;`&quot; quotes in the CLI form of table names, and report an error.</li>
</ul>
<h2 id="033---2020-03-30"><a class="header" href="#033---2020-03-30">0.3.3 - 2020-03-30</a></h2>
<h3 id="added-13"><a class="header" href="#added-13">Added</a></h3>
<ul>
<li>BigML: Honor BIGML_DOMAIN, allowing the user to point the BigML driver to a custom VPC instance of BigML.</li>
</ul>
<h2 id="032---2020-03-30"><a class="header" href="#032---2020-03-30">0.3.2 - 2020-03-30</a></h2>
<h3 id="fixed-20"><a class="header" href="#fixed-20">Fixed</a></h3>
<ul>
<li>Correctly quote BigQuery column names again (which regressed in 0.3.0), and added test cases to prevent further regressions.</li>
<li>Fix an error that caused <code>bigquery_upsert</code> test to fail.</li>
</ul>
<h2 id="031---2020-03-29"><a class="header" href="#031---2020-03-29">0.3.1 - 2020-03-29</a></h2>
<h3 id="added-14"><a class="header" href="#added-14">Added</a></h3>
<ul>
<li>Write a new <a href="https://www.dbcrossbar.org/">manual</a>!</li>
</ul>
<h3 id="changed-19"><a class="header" href="#changed-19">Changed</a></h3>
<ul>
<li>Encapsulate all calls to <code>bq</code> and <code>gsutil</code></li>
<li>Improve performance of <code>--stream-size</code></li>
</ul>
<h3 id="fixed-21"><a class="header" href="#fixed-21">Fixed</a></h3>
<ul>
<li>BigQuery: Honor NOT NULL on import (fixes #45)</li>
</ul>
<h2 id="030---2020-03-26"><a class="header" href="#030---2020-03-26">0.3.0 - 2020-03-26</a></h2>
<h3 id="added-15"><a class="header" href="#added-15">Added</a></h3>
<ul>
<li>Use <code>cargo deny</code> to enforce license and duplicate dependency policies</li>
<li>Add notes about license and contribution policies</li>
</ul>
<h3 id="changed-20"><a class="header" href="#changed-20">Changed</a></h3>
<ul>
<li>Update to tokio 0.2 and the latest stable Rust</li>
<li>Replace <code>wkb</code> with <code>postgis</code> for licensing reasons</li>
<li>BigML: Fail immediately if no S3 temporary bucket provided (fixes #101)</li>
</ul>
<h3 id="fixed-22"><a class="header" href="#fixed-22">Fixed</a></h3>
<ul>
<li>BigQuery: Handle mixed-case column names using BigQuery semantics (fixes #84)</li>
<li>PostgreSQL: Fix upserts with mixed-case column names</li>
<li>BigQuery: Correctly output NULL values in Boolean columns (#104)</li>
</ul>
<h3 id="removed-5"><a class="header" href="#removed-5">Removed</a></h3>
<ul>
<li>BREAKING: BigQuery: Remove code that tried to rename column names to make them valid (fixes #84)</li>
</ul>

                </main>

                <nav class="nav-wrapper" aria-label="Page navigation">
                    <!-- Mobile navigation buttons -->
                    <a rel="prev" href="dbcrossbar-ts.html" class="mobile-nav-chapters previous"
                        title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="credits.html" class="mobile-nav-chapters next"
                        title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                    <div style="clear: both"></div>
                </nav>
            </div>
        </div>

        <nav class="nav-wide-wrapper" aria-label="Page navigation">
            <a rel="prev" href="dbcrossbar-ts.html" class="nav-chapters previous" title="Previous chapter"
                aria-label="Previous chapter" aria-keyshortcuts="Left">
                <i class="fa fa-angle-left"></i>
            </a>
            <a rel="next" href="credits.html" class="nav-chapters next" title="Next chapter"
                aria-label="Next chapter" aria-keyshortcuts="Right">
                <i class="fa fa-angle-right"></i>
            </a>
        </nav>

    </div>

    <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
    <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
    <script src="book.js" type="text/javascript" charset="utf-8"></script>

    <!-- Custom JS scripts -->
</body>

</html>